angular.module("docsPlayer",["ui.router","book"]).provider("fastclick",function(){FastClick.attach(document.body),this.$get=function(){return{}}}).provider("runtimeStates",["$stateProvider",function(t){this.$get=[function(){return{addState:function(e,o){t.state(e,o)}}}]}]).config(["$stateProvider","fastclickProvider","$locationProvider",function(t,e,o){o.html5Mode(!0),t.state("main",{url:"/",templateUrl:"tpl/empty"})}]).factory("chapterContext",function(){var t,e;return{set:function(o,n){e&&(e.active=!1),e=n,t=o,e.active=!0},getBook:function(){return t},getChapter:function(){return e}}}).controller("AppCtrl",["$scope","runtimeStates","$http","$location","$state","chapterContext",function(t,e,o,n,a,r){o.get("/docs/books.json").then(function(o){for(var c=t.books=o.data,i=null,l=0;l<c.length;l++)for(var u=c[l],s=u.chapters,d=0;d<s.length;d++){var f=s[d],h=f.permalink;f.state="state"+l+"-"+d,e.addState(f.state,{url:h,templateUrl:f.fileUrl,data:{book:u,chapter:f}}),h===n.path()&&(i=f.state)}t.$on("$stateChangeSuccess",function(t,e){r.set(e.data.book,e.data.chapter)}),i&&a.go(i,{},{location:!1})})}]).directive("scrollWatcher",["$window","$anchorScroll",function(t,e){return{link:function(o,n){o.$on("$viewContentLoaded",e),o.$watch(function(){return t.location.hash},function(t){t||n.scrollTop(0)})}}}]);
angular.module("book",["chapter"]).directive("book",function(){return{scope:{book:"="},replace:!0,templateUrl:"tpl/book",controller:["$scope","chapterContext",function(e,o){e.expanded=!1,e.toggleExpanded=function(){e.expanded=!e.expanded},e.expand=function(){e.expanded||o.getBook()!==e.book||(e.expanded=!0)},e.$watch(o.getBook,e.expand)}]}});
angular.module("chapter",[]).directive("chapter",function(){return{scope:{chapter:"="},replace:!0,templateUrl:"tpl/chapter",controller:["$scope","chapterContext","$window",function(e,t,n){e.expanded=!1,e.toggleExpanded=function(){e.expanded=!e.expanded},e.isBookmarkActive=function(t){return n.location.pathname.indexOf(e.chapter.ref)>-1&&n.location.hash.indexOf(t.ref)>-1},e.isChapterActive=function(e){return n.location.pathname.indexOf(e.ref)>-1&&!n.location.hash},e.expand=function(){e.expanded||t.getChapter()!==e.chapter||(e.expanded=!0)},e.$watch(t.getChapter,e.expand)}]}});