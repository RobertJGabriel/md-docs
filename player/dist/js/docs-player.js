angular.module("docsPlayer",["ui.router","book"]).provider("fastclick",function(){FastClick.attach(document.body),this.$get=function(){return{}}}).provider("runtimeStates",["$stateProvider",function(t){this.$get=[function(){return{addState:function(e,n){t.state(e,n)}}}]}]).config(["$stateProvider","fastclickProvider","$locationProvider",function(t,e,n){n.html5Mode(!0),t.state("main",{url:"/",templateUrl:"tpl/empty"})}]).factory("chapterContext",function(){var t,e;return{set:function(n,o){e&&(e.active=!1),e=o,t=n,e.active=!0},getBook:function(){return t},getChapter:function(){return e}}}).controller("AppCtrl",["$scope","runtimeStates","$http","$location","$state","chapterContext",function(t,e,n,o,r,a){function i(t){return"<div ng-non-bindable>"+t+"</div>"}function c(t,n){n.state="state"+ ++l,e.addState(n.state,{url:n.permalink,fileUrl:n.fileUrl,data:{book:t,chapter:n},templateProvider:["$q","$http",function(t,e){var o=t.defer();return e.get(n.fileUrl).then(function(t){o.resolve(i(t.data))}),o.promise}]})}var l=0;n.get("/docs/books.json").then(function(e){for(var n=t.books=e.data,i=null,l=0;l<n.length;l++)for(var u=n[l],s=u.chapters,f=0;f<s.length;f++){var d=s[f];c(u,d),d.permalink===o.path()&&(i=d.state)}t.$on("$stateChangeSuccess",function(t,e){a.set(e.data.book,e.data.chapter)}),i&&r.go(i,{},{location:!1})})}]).directive("scrollWatcher",["$window","$anchorScroll",function(t,e){return{link:function(n,o){n.$on("$viewContentLoaded",e),n.$watch(function(){return t.location.hash},function(t){t||o.scrollTop(0)})}}}]);
angular.module("book",["chapter"]).directive("book",function(){return{scope:{book:"="},replace:!0,templateUrl:"tpl/book",controller:["$scope","chapterContext",function(e,o){e.expanded=!1,e.toggleExpanded=function(){e.expanded=!e.expanded},e.expand=function(){e.expanded||o.getBook()!==e.book||(e.expanded=!0)},e.$watch(o.getBook,e.expand)}]}});
angular.module("chapter",[]).directive("chapter",function(){return{scope:{chapter:"="},replace:!0,templateUrl:"tpl/chapter",controller:["$scope","chapterContext","$window",function(e,t,a){e.expanded=!1,e.toggleExpanded=function(){e.expanded=!e.expanded},e.isBookmarkActive=function(t){return a.location.pathname===e.chapter.permalink&&a.location.hash==="#"+t.ref},e.isChapterActive=function(t){return a.location.pathname===e.chapter.permalink&&!a.location.hash},e.expand=function(){e.expanded||t.getChapter()!==e.chapter||(e.expanded=!0)},e.$watch(t.getChapter,e.expand)}]}});